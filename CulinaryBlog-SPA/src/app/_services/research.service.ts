import { HttpClient } from '@angular/common/http';
import { Injectable } from '@angular/core';
import { map } from 'rxjs/operators';

@Injectable({
  providedIn: 'root'
})
export class ResearchService {
baseUrl="http://10.1.53.93:5002";
elsticsearchUrl="http://10.1.53.93:9200";
constructor(private httpClient:HttpClient) { }


researchOne(malwareModuleObject :number,moduleName : any)
{

    console.log("Scan: "+this.baseUrl+"/scan/"+malwareModuleObject+"/"+moduleName);
    return this.httpClient.get(this.baseUrl+"/scan/"+malwareModuleObject+"/"+moduleName).pipe(
      map((response: any)=>{
        console.log(response);
      })
    );


 
}

researchMany(groupToResearch: any)
{
  return this.httpClient.post(this.baseUrl+"/scanMany/", groupToResearch).pipe(
    map((response: any)=>{
      
      console.log(response);
      
    })
  );
}

getResearchHistory(malware : string, module: string)
{

  let query :any = JSON.stringify('{"size":1,"query" : {"match" : { "malware_name" : "' +malware + '" }}}');
  let query2: any={"size":1,"query" : {"match" : { "malware_name" :" 5d888b4fe8ddf93450aee7e0 " }}};
  console.log(query);
 
  


  return this.httpClient.get(this.elsticsearchUrl+"/"+module+"/_search", query2);
}
}
